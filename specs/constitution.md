# OpenClaw 飞书图片发送修复工具 - 项目宪法

## 1. 代码质量标准

### 1.1 语言规范
- 使用 TypeScript 编写核心逻辑
- 使用 Shell/Bash 编写安装和运行脚本
- 所有代码必须有中文注释

### 1.2 代码风格
- 使用 2 空格缩进
- 函数必须有 JSDoc 注释
- 变量使用 camelCase 命名
- 常量使用 UPPER_SNAKE_CASE 命名

### 1.3 错误处理
- 所有操作必须有 try-catch 包装
- 错误信息必须包含上下文
- 错误必须记录到日志文件

## 2. 测试覆盖率要求

### 2.1 单元测试
- 核心函数测试覆盖率 >= 80%
- 边界条件必须测试
- 错误路径必须测试

### 2.2 集成测试
- 必须测试完整的修复流程
- 必须测试撤销流程
- 必须测试检测流程

## 3. 性能基准

### 3.1 响应时间
- 检测操作：< 5 秒
- 修复操作：< 10 秒（不含服务重启）
- 撤销操作：< 10 秒（不含服务重启）

### 3.2 资源占用
- 内存占用 < 100MB
- 不产生临时文件（或自动清理）

## 4. 安全要求

### 4.1 文件操作
- 修改前必须备份原始文件
- 备份文件必须有时间戳
- 不修改用户数据

### 4.2 权限检查
- 必须检查是否有文件写入权限
- 必须检查是否有服务重启权限

## 5. API 设计原则

### 5.1 命令行接口
```bash
# 检测问题
openclaw-feishu-fixer check

# 应用修复
openclaw-feishu-fixer fix

# 撤销修复
openclaw-feishu-fixer undo

# 查看状态
openclaw-feishu-fixer status
```

### 5.2 退出码
- 0: 成功
- 1: 一般错误
- 2: 权限不足
- 3: 文件不存在
- 4: 已修复/未修复（根据命令而定）

## 6. 日志规范

### 6.1 日志级别
- INFO: 正常操作信息
- WARN: 警告信息（可继续）
- ERROR: 错误信息（需关注）
- DEBUG: 调试信息

### 6.2 日志格式
```
[YYYY-MM-DD HH:mm:ss] [LEVEL] message
```

## 7. 兼容性要求

### 7.1 OpenClaw 版本
- 支持 OpenClaw 2026.2.x 版本
- 自动检测 OpenClaw 安装路径

### 7.2 系统要求
- Linux (systemd)
- Node.js 18+
- TypeScript 5+
